/*Marquee.js|@author:ScottMunn.com|@version:0.7*/function activate_marquee_hashchange(){var e=window.location.hash;var t=$('.marquee-nav li a[href*="'+e+'"]');$("._autoCurrentHash").removeClass("_autoCurrentHash");$.each(t,function(){var e=$(this),t=e.parent("li").index(),n=e.parents(".marquee").first();n.trigger("hashUpdate").marqueeGoTo(t)});update_current_hashlinks(e)}function update_current_hashlinks(e){$("._autoCurrentHash").removeClass("_autoCurrentHash");if(e!=""&&e!="#"){$('a[href*="'+e+'"]').not('.marquee-nav li a[href*="'+e+'"]').addClass("_autoCurrentHash")}}function cloneObject(e){for(i in e){if(typeof e[i]=="source"){this[i]=new cloneObject(e[i])}else{this[i]=e[i]}}}var global_marquee_settings={css_active_name:"current",fade_text:true,fade_text_selectors:"h1,.summary",hide_transitions:false,transition_speed:500,marquee_caption:"marquee_current_description",autoplay:false,autoplay_slide_duration:4e3,resizable:true,touchstartevent:"ontouchstart"in document.documentElement?"touchstart":"mousedown",touchmoveevent:"ontouchmove"in document.documentElement?"touchmove":"mousemove",touchendevent:"ontouchend"in document.documentElement?"touchend":"mouseup",touchMode:"swipe",enableTouch:true,hoverActivate:false,swipeThreshold:30,autosize:false,orientationevent:"onorientationchange"in window?"orientationchange":"resize",autoselect:true};$.fn.marqueeize=function(e){var t=new cloneObject(global_marquee_settings);if("onhashchange"in window){$(window).bind("hashchange",function(){activate_marquee_hashchange()})}if(window.location.hash){var n=window.location.hash;var r=$('.marquee-nav li a[href="'+n+'"]');if(r.length==1){index=r.parent("li").index();r.parent("li").addClass(t.css_active_name).siblings().removeClass(t.css_active_name);update_current_hashlinks(n)}}return this.each(function(){var t=$(this);var n=new cloneObject(global_marquee_settings);n._m=$(t);n._id=t.attr("id");if(t.hasClass("hasBeenMarqueed")){}else{t.trigger("init");t.addClass("hasBeenMarqueed");if(e){$.extend(n,e)}if(t.hasClass("fixed")){n.resizable=false}else{n.resizable=true}if(t.hasClass("hover-activate")){n.hoverActivate=true}else{n.hoverActivate=false}if(t.hasClass("autosize")){n.autosize=true}else{n.autosize=false}if(t.hasClass("no-autoselect")){n.autoselect=false}else{n.autosize=true}if(n.autosize){console.log(n);var r=t.width();t.addClass("autosized").find(".marquee-panel,.marquee-viewport").width(r);var i=true;var s;$(window).on(n.orientationevent,function(){var e=t.width();t.find(".marquee-panel,.marquee-viewport").width(e);clearTimeout(s);s=setTimeout(function(){console.log("Fixing");t.marqueeGoTo("current",null,n)},200)})}t.find(".marquee-nav li").on("click",function(e){e.preventDefault();t.trigger("navClick");$(this).marqueeClick()});if(n.hoverActivate){t.find(".marquee-nav li").on("mouseover",function(e){e.preventDefault();t.trigger("navHover");$(this).marqueeClick()})}t.find(".marquee_prev").first().on("click",function(e){e.preventDefault();$(this).parents(".marquee").trigger("prev").first().marqueeGoTo("prev",null,n)});t.find(".marquee_next").first().on("click",function(e){e.preventDefault();$(this).parents(".marquee").trigger("next").first().marqueeGoTo("next",null,n)});t.find(".marquee_first").first().on("click",function(e){e.preventDefault();$(this).parents(".marquee").trigger("first").first().marqueeGoTo("first",null,n)});t.find(".marquee_last").first().on("click",function(e){e.preventDefault();$(this).parents(".marquee").trigger("last").first().marqueeGoTo("last",null,n)});t.find(".marquee_random").first().on("click",function(e){e.preventDefault();$(this).parents(".marquee").trigger("random").first().marqueeGoTo("random",null,n)});t.find(".marquee_deselect").first().on("click",function(e){e.preventDefault();$(this).parents(".marquee").trigger("deselect").removeClass("has-selection").find(".current").removeClass("current")});if(n.enableTouch&&!t.hasClass("clickToFocus")){t.on(n.touchstartevent,function(e){$(this).addClass("swiping");var r=e.clientX,i=$(this).find(".marquee-panels").css("margin-left").replace("px","");if(n.touchstartevent=="mousedown"){e.preventDefault()}var s=e.pageX?e.pageX:e.originalEvent.changedTouches[0].pageX,o=e.pageY?e.pageY:e.originalEvent.changedTouches[0].pageY;$(this).data({start_x:s,start_y:o});if(n.touchMode=="drag"){t.addClass("touch-event-occurring");t.on(n.touchmoveevent,function(e){e.preventDefault();var n=e.pageX?e.pageX:e.originalEvent.changedTouches[0].pageX;var s=n-parseInt(r);var o=parseInt(i)+parseInt(s);t.find(".marquee-panels").css("margin-left",o)})}});t.on(n.touchendevent,function(e){t.off(n.touchmoveevent);setTimeout(function(){t.removeClass("touch-event-occurring").removeClass("swiping")},1e3);var r=false;var i,s,o=e.pageX?e.pageX:e.originalEvent.changedTouches[0].pageX,u=e.pageY?e.pageY:e.originalEvent.changedTouches[0].pageY;var a=$(this).data("start_x")-o,f=$(this).data("start_y")-u;if(a<0){i="left"}else if(a>0){i="right"}if(f<0){s="up"}else if(f>0){s="down"}if(Math.abs(a)>Math.abs(f)){if(Math.abs(a)>n.swipeThreshold){t.trigger("swiped");if(i=="left"){if($(this).find(".marquee-panel."+n.css_active_name).index()!=0){$(this).marqueeGoTo("prev",null,n);r=true}else{var l=$(this).find(".marquee-panels").css("margin-left").replace("px","");var c=40;if($(this).attr("data-left-offset")){c=c+$(this).attr("data-left-offset")}$(this).find(".marquee-panels").animate({"margin-left":l+c},200).animate({"margin-left":l},400,jQuery.easing["easeOutBounce"]?"easeOutBounce":"swing");r=true}}else if(i=="right"){if($(this).find(".marquee-panel."+n.css_active_name).index()!=parseInt(t.find(".marquee-panel").length-1)){$(this).marqueeGoTo("next",null,n);r=true}else{var l=$(this).find(".marquee-panels").css("margin-left").replace("px","");$(this).find(".marquee-panels").animate({"margin-left":l-40},200).animate({"margin-left":l},400,jQuery.easing["easeOutBounce"]?"easeOutBounce":"swing");r=true}}}}else{}$(this).data({start_x:null,end_x:null});if(r==false&&a>0){t.marqueeGoTo("current",null,n)}})}t.find(".marquee-nav .caption").hide();t.each(function(){var e=$(this),t=0;var r=e.find(".marquee-nav").first().find("."+n.css_active_name);if(r.length>0){t=r.index()}else{}if(t==0){e.marqueeGoTo("initialize",null,n)}else{e.marqueeGoTo(t,null,n)}var i=e.find(".marquee-panels").first().children(".marquee-panel").length;e.attr("data-original-length",i);if(e.find(".counter .total").length>0){e.find(".counter .total").html(i)}})}})};$.fn.marqueeClick=function(e){var t=new cloneObject(global_marquee_settings);return this.each(function(){if(e){$.extend(t,e)}if($(this).hasClass(t.css_active_name)){return}var n=$(this),r=$(this).parents(".marquee").first(),i=$(this).index();n.addClass(t.css_active_name);$(r).marqueeGoTo(i,null,t)})};$.fn.marqueeAutoplay=function(){return this.each(function(){var e=$(this);e.hover(function(){$.data(this,"hover",true)},function(){$.data(this,"hover",false)}).data("hover",false).data("autoplay",true);e.find(".marquee-nav").click(function(){e.data("autoplay",false)});$(this).marqueeAutoplayEnable()})};$.fn.marqueeAutoplayEnable=function(){var e=$(this);var t=setInterval(function(){if(!e.data("hover")&&e.data("autoplay")){e.marqueeGoTo("next",null,settings)}},global_marquee_settings.autoplay_slide_duration);e.hover(function(){clearInterval(t)},function(){t=setInterval(function(){if(!e.data("hover")&&e.data("autoplay")){e.marqueeGoTo("next",null,settings)}},global_marquee_settings.autoplay_slide_duration)}).removeClass("autoplay-off").addClass("autoplay-on")};$.fn.marqueeGoTo=function(e,t,n){if(n==undefined){var r=new cloneObject(global_marquee_settings)}else{var r=n}if(e==null){e=0}var i=$(this);return this.each(function(){var n=$(this),i=false,s=n.find(".marquee-panels").first().children("."+r.css_active_name).index(),o=n.find(".marquee-panels").first().children(".marquee-panel").length-1;if(s==-1){s=0}switch(e){case"initialize":if(r.autoselect){s=-1;e=0;r.fade_text=false;var u=true;var a=true}else{e=null}break;case"current":e=s;i=true;break;case"next":if(n.hasClass("multiple")){var f=Math.floor(n.width()/n.find(".marquee-panel").width());e=parseInt(s+f);if(o-f>e){console.log(1)}else{console.log(2);e=o-f+1;console.log(e);n.addClass("current-page-last")}}else{e=parseInt(s+1)}break;case"prev":case"previous":if(n.hasClass("multiple")){var f=Math.floor(n.width()/n.find(".marquee-panel").width());e=parseInt(s-f);if(e<0){e=0}n.addClass("current-page-first")}else{e=parseInt(s-1)}break;case"last":e=o;break;case"first":e=0;break;case"random":e=s;while(e==s){e=Math.floor(Math.random()*(parseInt(o)+1))}break}if(e==null){return false}n.addClass("has-selection").removeClass("current-page-first current-page-last");if(n.hasClass("infinite")==true){var l=n.find(".marquee-panels").first(),c=$(l).children(".marquee-panel"),h=l.width();if(e==o){c.clone().appendTo(l);l.width(h*2);o=o*2+1}if(e<0){e=o;c.clone().prependTo(l);l.width(h*2);o=o*2+1;e=o;var u=true}}else{if(e<0){e=o}if(e>o){e=0}}if(t!=null){e=t}if(s!=e||i){var p=n.find(".marquee-panels").first(),d=n.find(".marquee-viewport").first(),v=n.find(".marquee-nav").first(),m=n.find(".marquee-panels").first().find(".marquee-panel:eq("+e+")"),g=m.outerHeight(),y=m.position(),b=p.css("margin-left").replace("px",""),w=parseInt(y.left,10)-parseInt(b,10),E=n.attr("data-left-offset"),S=$(r.fade_text_selectors,n);if(E){w=w-E}var x=n.css("padding-left").replace("px","");w=parseInt(w,10)-parseInt(x,10);v.find("."+r.css_active_name).removeClass(r.css_active_name);v.find("li:eq("+e+")").addClass(r.css_active_name);n.find(".marquee-panels").first().children("."+r.css_active_name).removeClass(r.css_active_name);m.addClass(r.css_active_name);n.removeClass("current-panel-"+n.attr("data-current-panel")).attr("data-current-panel",parseInt(e)+1).addClass("current-panel-"+(parseInt(e)+1));if(e==0){n.addClass("current-panel-first").removeClass("current-panel-last").trigger("beginning")}else if(e==o){n.addClass("current-panel-last").removeClass("current-panel-first").trigger("end")}else{n.removeClass("current-panel-first current-panel-last")}n.find(".counter .index").html(parseInt(e)+1);if(n.find("."+r.marquee_caption).length){var T=$(v).find("li:eq("+e+") .caption").html();if(T==null){var T=$(v).find("li:eq("+e+")").attr("title")}if(T){$(n).find("."+r.marquee_caption).fadeTo(500,1).html(T)}else{$(n).find("."+r.marquee_caption).fadeTo(500,0)}}w=w*-1;if(r.hide_transitions&&s!=-1||u==true){var N=n.find("h1,.summary");if(N.length>0){N.fadeTo(10,0,function(){p.css({"margin-left":w},1e3,"swing",function(){N.fadeTo(100,1);if(r.resizable==true){d.css({height:g+"px"});p.css({height:g+"px"})}})})}else{p.css({"margin-left":w},1e3,"swing",function(){N.fadeTo(10,1);if(r.resizable==true){d.css({height:g+"px"});p.css({height:g+"px"})}})}}else{if(r.fade_text){S.fadeTo(400,.1)}if($(n).hasClass("fast")==true){r.transition_speed=1}p.animate({"margin-left":w},r.transition_speed,"swing",function(){if(r.resizable==true&&g!=d.height()){d.animate({height:g+"px"},r.transition_speed/2);p.animate({height:g+"px"},r.transition_speed/2)}})}var C=$(n).attr("data-original-length");if(C!=null){$("#current_slide").text(e%C+1+"/"+C)}else{$("#current_slide").text(e+1+"/"+(o+1))}if(a==true){if(r.hide_transitions){d.css({height:g+"px"});p.css({height:g+"px"})}else{d.animate({height:g+"px"},r.transition_speed/2);p.animate({height:g+"px"},r.transition_speed/2)}}if(v){update_current_hashlinks(v.find(".current a").attr("href"))}setTimeout(function(){n.trigger("newPanel")},300)}})};$(function(){if($(".marquee.fade").length>0){$(".marquee.fade").not(".custom").marqueeize({hide_transitions:true})}if($(".marquee:not(.fade),.marquee.slide").length>0){$(".marquee:not(.fade),.marquee.slide").not(".custom").marqueeize()}if($(".marquee.autoplay").length>0){$(".marquee.autoplay").marqueeAutoplay();$(".autoplay .pause").click(function(){var e=$(this).parents(".marquee").first(),t=e.data("autoplay");if(t){$(this).html("play");e.removeClass("autoplay-on").addClass("autoplay-off").data("autoplay",false)}else{$(this).html("pause");e.removeClass("autoplay-off").addClass("autoplay-on").data("autoplay",true)}})}$(".clickToFocus .marquee-panel").live("click",function(){if(!$(this).closest(".marquee").hasClass("swiping")&&!$(this).hasClass("current")){$(this).closest(".marquee").trigger("clickToFocus").marqueeGoTo($(this).index())}else{}});$(".clickToFocus .marquee-panel a").live("click",function(e){if(!$(this).closest(".marquee-panel").is(".current")){$(this).closest(".marquee").marqueeGoTo($(this).closest(".marquee-panel").index());return false}})});(function(e,t,n){function f(e){e=e||location.href;return"#"+e.replace(/^[^#]*#?(.*)$/,"$1")}var r="hashchange",i=document,s,o=e.event.special,u=i.documentMode,a="on"+r in t&&(u===n||u>7);e.fn[r]=function(e){return e?this.bind(r,e):this.trigger(r)};e.fn[r].delay=50;o[r]=e.extend(o[r],{setup:function(){if(a){return false}e(s.start)},teardown:function(){if(a){return false}e(s.stop)}});s=function(){function m(){var n=f(),i=v(u);if(n!==u){p(u=n,i);e(t).trigger(r)}else{if(i!==u){location.href=location.href.replace(/#.*/,"")+i}}o=setTimeout(m,e.fn[r].delay)}var s={},o,u=f(),l=function(e){return e},p=l,v=l;s.start=function(){o||m()};s.stop=function(){o&&clearTimeout(o);o=n};e.browser.msie&&!a&&function(){var t,n;s.start=function(){if(!t){n=e.fn[r].src;n=n&&n+f();t=e('<iframe tabindex="-1" title="empty"/>').hide().one("load",function(){n||p(f());m()}).attr("src",n||"javascript:0").insertAfter("body")[0].contentWindow;i.onpropertychange=function(){try{if(event.propertyName==="title"){t.document.title=i.title}}catch(e){}}}};s.stop=l;v=function(){return f(t.location.href)};p=function(n,s){var o=t.document,u=e.fn[r].domain;if(n!==s){o.title=i.title;o.open();u&&o.write('<script>document.domain="'+u+'"</script>');o.close();t.location.hash=n}}}();return s}()})(jQuery,this)